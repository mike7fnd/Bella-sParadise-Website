<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reset Password — Bella's Paradise Resort</title>

  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700&family=Playfair+Display:wght@600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

  <style>
    :root{
      --base-font:"Archivo",sans-serif;--logo-font:"Playfair Display",serif;
      --bg-dark:#181818;--muted:#e4bdd1;--accent:#e6a8ce;--white:#ffffff;
      --glass-bg:rgba(0,0,0,0.35);--shadow:0 8px 32px rgba(0,0,0,0.25);
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body{height:100%;color:var(--white);background:var(--bg-dark);font-family:var(--base-font);}
    .site{width:100%;min-height:100vh;display:flex;flex-direction:column;align-items:center;}
    .hero{width:100%;max-width:1400px;margin:auto;position:relative;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px;}
    .hero-bg{position:absolute;inset:0;background:linear-gradient(180deg,rgba(21,17,14,.233),rgba(21,17,14,.247)),url("https://scontent-mnl3-3.xx.fbcdn.net/v/t39.30808-6/491998749_122174434196314282_8701410998447490278_n.jpg?_nc_cat=101&ccb=1-7&_nc_sid=833d8c&_nc_eui2=AeF79WRB2PoycUzkiHJWc2SQOvlpsVs8ZZU6-WmxWzxllU5OnL1UNvYBfrTxn2QbZwoAy2XLic9kbrN8UsqtoRNL&_nc_ohc=X1iOIZ-i_HwQ7kNvwGLpJE2&_nc_oc=AdlroZBwo0YIrTP4nbPKyKSfiNUnIgBdnQlQCpCtlS_-WV05LJIT9jhvqqfpSE9SKz4&_nc_zt=23&_nc_ht=scontent-mnl3-3.xx&_nc_gid=0tbB9NhwvDUVadCyFNIjTw&oh=00_AfjFa4NtMwGZpahrN5xuH4BAvo0zZUG3kYdpp1ECMOw_kg&oe=69259A5A");background-size:cover;background-position:center 18%;z-index:1;}
    .card{position:relative;z-index:2;background:var(--glass-bg);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:50px;padding:36px 32px;width:min(480px,92vw);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.12);display:flex;flex-direction:column;gap:22px;}
    .logo{font-family:var(--logo-font);font-size:2rem;font-style:italic;font-weight:200;text-align:center;}
    .title{font-size:1.45rem;text-align:center;margin-bottom:6px;}
    .text{font-size:.92rem;color:var(--muted);text-align:center;line-height:1.5;}
    .progress{margin:20px 0 10px;display:flex;justify-content:center;gap:12px;}
    .step-dot{width:36px;height:36px;background:rgba(255,255,255,.15);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;transition:all .3s;}
    .step-dot.active{background:var(--accent);color:#111;transform:scale(1.1);}
    .step-dot.done{background:var(--white);color:#111;}
    .form-group{display:flex;flex-direction:column;gap:6px;margin-bottom:18px;}
    label{font-size:.85rem;color:var(--muted);font-weight:300;}
    input{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.16);border-radius:30px;padding:13px 14px;color:var(--white);font-size:1rem;transition:all .22s;}
    input::placeholder{color:rgba(255,255,255,.48);}
    input:focus{outline:none;border-color:var(--accent);background:rgba(255,255,255,.12);box-shadow:0 0 0 3px rgba(189,165,137,.22);}
    .btn{background:var(--white);color:#111;border:none;padding:13px 16px;border-radius:30px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .22s;}
    .btn:hover{background:#e03d8f;color:#fff;transform:translateY(-1px);}
    .btn-secondary{background:transparent;color:var(--accent);border:1px solid var(--accent);}
    .btn-group{display:flex;gap:12px;margin-top:12px;}
    .step{display:none;}
    .step.active{display:block;animation:fade .6s;}
    @keyframes fade{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}
    .question-box{background:rgba(255,255,255,.08);padding:14px;border-radius:30px;font-size:.95rem;margin-top:4px;}
    .back-to-home{display:flex;align-items:center;justify-content:center;gap:6px;font-size:.88rem;color:var(--accent);margin-top:32px;font-weight:500;transition:all .2s;}
    .back-to-home:hover{color:#d6c0a0;transform:translateX(-2px);}
    .back-to-home svg{width:14px;height:14px;fill:currentColor;}
    @media(max-width:720px){.card{padding:28px 22px;}.logo{font-size:1.6rem;}}
  </style>
</head>
<body>

<div class="site">
  <section class="hero">
    <div class="hero-bg" role="img" aria-label="Resort at sunset"></div>

    <div class="card">
      <div class="logo">Bella's Paradise</div>

      <div class="progress">
        <div class="step-dot active" id="dot1">1</div>
        <div class="step-dot" id="dot2">2</div>
        <div class="step-dot" id="dot3">3</div>
      </div>

      <!-- Step 1: Enter Email -->
      <div class="step active" id="step1">
        <h1 class="title">Forgot Password?</h1>
        <p class="text">Enter your registered email address to begin.</p>
        <form id="emailForm">
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" required placeholder="you@example.com" autocomplete="email"/>
          </div>
          <div class="btn-group">
            <button type="submit" class="btn">Continue</button>
          </div>
        </form>
      </div>

      <!-- Step 2: Answer Security Questions -->
      <div class="step" id="step2">
        <h1 class="title">Security Questions</h1>
        <p class="text">Please answer the two questions you set during registration.</p>
        <form id="questionsForm">
          <div class="form-group">
            <label>Question 1</label>
            <div class="question-box" id="q1-text"></div>
            <input type="text" id="ans1" required placeholder="Your answer" style="margin-top:8px;">
          </div>
          <div class="form-group">
            <label>Question 2</label>
            <div class="question-box" id="q2-text"></div>
            <input type="text" id="ans2" required placeholder="Your answer" style="margin-top:8px;">
          </div>
          <div class="btn-group">
            <button type="button" class="btn btn-secondary" onclick="goBack()">Back</button>
            <button type="submit" class="btn">Verify Answers</button>
          </div>
        </form>
      </div>

      <!-- Step 3: Set New Password -->
      <div class="step" id="step3">
        <h1 class="title">Create New Password</h1>
        <p class="text">Your identity is verified. Choose a strong new password.</p>
        <form id="passwordForm" action="/reset-password" method="POST">
          <input type="hidden" name="email" id="finalEmail">
          <div class="form-group">
            <label>New Password</label>
            <input type="password" name="new_password" required minlength="6" placeholder="Enter new password">
          </div>
          <div class="form-group">
            <label>Confirm New Password</label>
            <input type="password" name="confirm_password" required placeholder="Repeat new password">
          </div>
          <div class="btn-group">
            <button type="button" class="btn btn-secondary" onclick="goBack()">Back</button>
            <button type="submit" class="btn">Reset Password</button>
          </div>
        </form>
      </div>

      <!-- Always visible Back to Home -->
      <a href="/" class="back-to-home" aria-label="Back to homepage">
        <svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        Back to Home
      </a>
    </div>
  </section>
</div>

<script>
  // Mock database — replace with real backend
  const users = {
    "juan@example.com": {
      q1: "What was your childhood nickname?",
      a1: "pogi",
      q2: "In what city were you born?",
      a2: "manila"
    }
  };

  let currentStep = 1;
  let userEmail = "";

  function updateProgress() {
    document.getElementById('dot1').classList.toggle('done', currentStep > 1);
    document.getElementById('dot1').classList.toggle('active', currentStep === 1);
    document.getElementById('dot2').classList.toggle('done', currentStep > 2);
    document.getElementById('dot2').classList.toggle('active', currentStep === 2);
    document.getElementById('dot3').classList.toggle('active', currentStep === 3);
  }

  function goToStep(n) {
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.getElementById('step'+n).classList.add('active');
    currentStep = n;
    updateProgress();
  }

  function goBack() {
    if(currentStep > 1) goToStep(currentStep - 1);
  }

  // Step 1 → Step 2
  document.getElementById('emailForm').onsubmit = e => {
    e.preventDefault();
    userEmail = document.getElementById('email').value.trim().toLowerCase();
    if(users[userEmail]){
      document.getElementById('q1-text').textContent = users[userEmail].q1;
      document.getElementById('q2-text').textContent = users[userEmail].q2;
      window.correctA1 = users[userEmail].a1;
      window.correctA2 = users[userEmail].a2;
      goToStep(2);
    } else {
      alert("No account found with that email.");
    }
  };

  // Step 2 → Step 3
  document.getElementById('questionsForm').onsubmit = e => {
    e.preventDefault();
    const a1 = document.getElementById('ans1').value.trim().toLowerCase();
    const a2 = document.getElementById('ans2').value.trim().toLowerCase();
    if(a1 === window.correctA1 && a2 === window.correctA2){
      document.getElementById('finalEmail').value = userEmail;
      goToStep(3);
    } else {
      alert("Incorrect answers. Please try again.");
    }
  };

  // Final submit
  document.getElementById('passwordForm').onsubmit = e => {
    const pw1 = document.querySelector('[name=new_password]').value;
    const pw2 = document.querySelector('[name=confirm_password]').value;
    if(pw1 !== pw2){ e.preventDefault(); alert("Passwords do not match!"); return; }
    if(pw1.length < 6){ e.preventDefault(); alert("Password too short."); return; }
    alert("Password successfully reset!");
    // window.location.href = "/login";
  };

  // GSAP entrance (exactly like login page)
  document.addEventListener('DOMContentLoaded', () => {
    gsap.from('.site', {opacity:0, duration:1, ease:'power2.out'});
    gsap.from('.card', {opacity:0, y:100, duration:1, delay:0.2, ease:'power2.out'});
    gsap.from('.logo', {opacity:0, scale:0.8, duration:0.8, delay:0.2, ease:'back.out(1.7)'});
    gsap.from('.progress,.title,.text,.form-group,.btn-group,.back-to-home', {
      y:20, opacity:0, duration:0.6, stagger:0.1, delay:0.5, ease:'power2.out'
    });

    document.querySelectorAll('input').forEach(i=>{
      i.addEventListener('focus',()=>gsap.to(i,{scale:1.02,duration:0.2}));
      i.addEventListener('blur',()=>gsap.to(i,{scale:1,duration:0.2}));
    });
    document.querySelectorAll('.btn').forEach(b=>{
      b.addEventListener('mouseenter',()=>gsap.to(b,{scale:1.05,duration:0.2}));
      b.addEventListener('mouseleave',()=>gsap.to(b,{scale:1,duration:0.2}));
    });
  });
</script>
</body>
</html>
